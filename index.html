<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crepe Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        .float-animation {
            animation: float 3s ease-in-out infinite;
        }
        .slide-in {
            animation: slideIn 0.5s ease-out;
        }
        .crepe-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f6e05e;
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .order-card {
            transition: all 0.3s ease;
        }
        .order-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        @media (max-width: 768px) {
            .mobile-stack {
                flex-direction: column;
            }
            .mobile-full {
                width: 100% !important;
            }
        }
    </style>
</head>
<body class="bg-yellow-50 min-h-screen">
    <!-- Firebase Configuration -->
    <script>
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            databaseURL: "YOUR_DATABASE_URL",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const auth = firebase.auth();
    </script>

    <!-- Main Container -->
    <div class="container mx-auto px-4 py-8">
        <!-- Header with Role Menu -->
        <header class="flex justify-between items-center mb-8">
            <h1 class="text-3xl font-bold text-yellow-800">Crepe Management System</h1>
            <div class="relative">
                <button id="roleMenuButton" class="p-2 rounded-full hover:bg-yellow-200 transition">
                    <i class="fas fa-ellipsis-v text-yellow-700 text-xl"></i>
                </button>
                <div id="roleMenu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10">
                    <div class="py-1">
                        <button onclick="showLogin('customer')" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-yellow-100">Kundenbereich</button>
                        <button onclick="showLogin('maker')" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-yellow-100">Hersteller Login</button>
                        <button onclick="showLogin('waiter')" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-yellow-100">Kellner Login</button>
                        <button onclick="showLogin('owner')" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-yellow-100">Owner Login</button>
                        <button onclick="showLogin('admin')" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-yellow-100">Admin Login</button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Customer View (Default) -->
        <div id="customerView" class="bg-white rounded-lg shadow-md p-6 mb-8 slide-in">
            <div class="text-center mb-8">
                <div class="float-animation inline-block">
                    <i class="fas fa-pancakes text-yellow-500 text-6xl"></i>
                </div>
                <h2 class="text-2xl font-bold text-yellow-800 mt-4">Willkommen beim Crepe Stand!</h2>
                <p class="text-yellow-600">Geben Sie Ihre Bestellnummer ein, um den Status zu sehen</p>
            </div>
            
            <div class="max-w-md mx-auto">
                <div class="mb-6">
                    <label for="orderNumber" class="block text-sm font-medium text-yellow-700 mb-2">Bestellnummer</label>
                    <input type="text" id="orderNumber" class="w-full px-4 py-2 border border-yellow-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500" placeholder="z.B. CR1234">
                </div>
                <button onclick="checkOrderStatus()" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-md transition duration-300 flex items-center justify-center">
                    <span>Status prüfen</span>
                    <i class="fas fa-search ml-2"></i>
                </button>
            </div>
            
            <div id="orderStatus" class="hidden mt-8 max-w-md mx-auto bg-yellow-100 border-l-4 border-yellow-500 p-4">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="font-bold text-yellow-800">Bestellung #<span id="displayOrderNumber"></span></h3>
                        <p class="text-yellow-700">Status: <span id="orderStatusText"></span></p>
                    </div>
                    <div id="orderTimer" class="text-2xl font-bold text-yellow-700"></div>
                </div>
                <div class="mt-4">
                    <p class="text-sm text-yellow-600"><span id="ordersBeforeYou"></span> Bestellungen vor Ihnen</p>
                    <div class="w-full bg-yellow-200 rounded-full h-2.5 mt-2">
                        <div id="progressBar" class="bg-yellow-600 h-2.5 rounded-full" style="width: 0%"></div>
                    </div>
                </div>
                <div id="readyAlert" class="hidden mt-4 pulse-animation bg-yellow-500 text-white p-3 rounded-md text-center">
                    <i class="fas fa-bell mr-2"></i> Ihre Bestellung ist fertig! Bitte kommen Sie zum Crepe Stand.
                </div>
            </div>
            
            <div class="mt-12 text-center">
                <h3 class="text-xl font-bold text-yellow-800 mb-4">Aktuelle Wartezeiten</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 max-w-4xl mx-auto">
                    <div class="bg-yellow-100 p-4 rounded-lg">
                        <div class="text-yellow-700 font-medium">Station 1</div>
                        <div class="text-2xl font-bold text-yellow-800" id="station1Time">5 min</div>
                    </div>
                    <div class="bg-yellow-100 p-4 rounded-lg">
                        <div class="text-yellow-700 font-medium">Station 2</div>
                        <div class="text-2xl font-bold text-yellow-800" id="station2Time">7 min</div>
                    </div>
                    <div class="bg-yellow-100 p-4 rounded-lg">
                        <div class="text-yellow-700 font-medium">Station 3</div>
                        <div class="text-2xl font-bold text-yellow-800" id="station3Time">3 min</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Login Modals -->
        <div id="loginModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg p-6 w-full max-w-md">
                <div class="flex justify-between items-center mb-4">
                    <h3 id="loginTitle" class="text-xl font-bold text-yellow-800">Login</h3>
                    <button onclick="hideLogin()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="mb-4">
                    <label for="loginUsername" class="block text-sm font-medium text-yellow-700 mb-2">Benutzername</label>
                    <input type="text" id="loginUsername" class="w-full px-4 py-2 border border-yellow-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500">
                </div>
                <div class="mb-6">
                    <label for="loginPassword" class="block text-sm font-medium text-yellow-700 mb-2">Passwort</label>
                    <input type="password" id="loginPassword" class="w-full px-4 py-2 border border-yellow-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500">
                </div>
                <button id="loginButton" onclick="login()" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-md transition duration-300">
                    Einloggen
                </button>
            </div>
        </div>

        <!-- Maker View -->
        <div id="makerView" class="hidden bg-white rounded-lg shadow-md p-6 mb-8">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-yellow-800">Hersteller Dashboard</h2>
                <button onclick="logout()" class="text-yellow-700 hover:text-yellow-900 flex items-center">
                    <i class="fas fa-sign-out-alt mr-2"></i> Ausloggen
                </button>
            </div>
            
            <div class="mb-6">
                <label class="block text-sm font-medium text-yellow-700 mb-2">Station auswählen</label>
                <div class="flex space-x-4">
                    <button onclick="selectStation(1)" id="station1Btn" class="flex-1 py-2 px-4 border border-yellow-300 rounded-md hover:bg-yellow-100 transition">Station 1</button>
                    <button onclick="selectStation(2)" id="station2Btn" class="flex-1 py-2 px-4 border border-yellow-300 rounded-md hover:bg-yellow-100 transition">Station 2</button>
                    <button onclick="selectStation(3)" id="station3Btn" class="flex-1 py-2 px-4 border border-yellow-300 rounded-md hover:bg-yellow-100 transition">Station 3</button>
                </div>
            </div>
            
            <div id="makerStationInfo" class="hidden mb-6 p-4 bg-yellow-100 rounded-md">
                <h3 class="font-bold text-yellow-800 mb-2">Aktuelle Station: <span id="currentStation"></span></h3>
                <p class="text-yellow-700">Status: <span id="stationStatus">Bereit</span></p>
            </div>
            
            <div id="currentOrder" class="hidden mb-8 p-6 bg-white border border-yellow-200 rounded-lg shadow-sm">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold text-yellow-800">Aktuelle Bestellung</h3>
                    <span class="bg-yellow-500 text-white text-xs font-bold px-2 py-1 rounded">#<span id="currentOrderNumber"></span></span>
                </div>
                <div id="orderDetails" class="mb-4">
                    <!-- Order details will be populated here -->
                </div>
                <div class="flex justify-end space-x-3">
                    <button onclick="markOrderAsDone()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-md transition duration-300">
                        Fertigstellen
                    </button>
                    <button onclick="cancelCurrentOrder()" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-md transition duration-300">
                        Stornieren
                    </button>
                </div>
            </div>
            
            <div id="noOrders" class="text-center py-8">
                <div class="inline-block mb-4">
                    <i class="fas fa-concierge-bell text-yellow-500 text-5xl"></i>
                </div>
                <h3 class="text-xl font-bold text-yellow-800 mb-2">Keine aktiven Bestellungen</h3>
                <p class="text-yellow-600">Warten Sie auf neue Bestellungen für Ihre Station</p>
            </div>
            
            <div id="orderQueue" class="mt-8">
                <h3 class="text-lg font-bold text-yellow-800 mb-4">Warteschlange</h3>
                <div id="queueList" class="space-y-3">
                    <!-- Order queue will be populated here -->
                </div>
            </div>
        </div>

        <!-- Waiter View -->
        <div id="waiterView" class="hidden bg-white rounded-lg shadow-md p-6 mb-8">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-yellow-800">Kellner Dashboard</h2>
                <div>
                    <button onclick="logout()" class="text-yellow-700 hover:text-yellow-900 flex items-center">
                        <i class="fas fa-sign-out-alt mr-2"></i> Ausloggen
                    </button>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-yellow-50 p-4 rounded-lg">
                    <h3 class="font-bold text-yellow-800 mb-3">Vordefinierte Crepes</h3>
                    <div class="space-y-2">
                        <button onclick="addPredefinedOrder('Classic', 4.50)" class="w-full text-left p-2 hover:bg-yellow-100 rounded flex justify-between items-center">
                            <span>Classic (Zucker & Zitrone)</span>
                            <span class="bg-yellow-200 text-yellow-800 px-2 py-1 rounded text-sm">4.50€</span>
                        </button>
                        <button onclick="addPredefinedOrder('Nutella', 5.00)" class="w-full text-left p-2 hover:bg-yellow-100 rounded flex justify-between items-center">
                            <span>Nutella</span>
                            <span class="bg-yellow-200 text-yellow-800 px-2 py-1 rounded text-sm">5.00€</span>
                        </button>
                        <button onclick="addPredefinedOrder('Erdbeer-Nutella', 6.00)" class="w-full text-left p-2 hover:bg-yellow-100 rounded flex justify-between items-center">
                            <span>Erdbeer-Nutella</span>
                            <span class="bg-yellow-200 text-yellow-800 px-2 py-1 rounded text-sm">6.00€</span>
                        </button>
                        <button onclick="addPredefinedOrder('Banane-Nutella', 5.50)" class="w-full text-left p-2 hover:bg-yellow-100 rounded flex justify-between items-center">
                            <span>Banane-Nutella</span>
                            <span class="bg-yellow-200 text-yellow-800 px-2 py-1 rounded text-sm">5.50€</span>
                        </button>
                    </div>
                </div>
                
                <div class="bg-yellow-50 p-4 rounded-lg">
                    <h3 class="font-bold text-yellow-800 mb-3">Beliebte Kombinationen</h3>
                    <div class="space-y-2">
                        <button onclick="addPredefinedOrder('Haus-Spezial', 7.00)" class="w-full text-left p-2 hover:bg-yellow-100 rounded flex justify-between items-center">
                            <span>Haus-Spezial</span>
                            <span class="bg-yellow-200 text-yellow-800 px-2 py-1 rounded text-sm">7.00€</span>
                        </button>
                        <button onclick="addPredefinedOrder('Kinder-Crepe', 5.50)" class="w-full text-left p-2 hover:bg-yellow-100 rounded flex justify-between items-center">
                            <span>Kinder-Crepe</span>
                            <span class="bg-yellow-200 text-yellow-800 px-2 py-1 rounded text-sm">5.50€</span>
                        </button>
                        <button onclick="addPredefinedOrder('Fitness', 6.50)" class="w-full text-left p-2 hover:bg-yellow-100 rounded flex justify-between items-center">
                            <span>Fitness (Honig & Nüsse)</span>
                            <span class="bg-yellow-200 text-yellow-800 px-2 py-1 rounded text-sm">6.50€</span>
                        </button>
                    </div>
                </div>
                
                <div class="bg-yellow-50 p-4 rounded-lg">
                    <h3 class="font-bold text-yellow-800 mb-3">Getränke</h3>
                    <div class="space-y-2">
                        <button onclick="addPredefinedOrder('Cola', 2.50)" class="w-full text-left p-2 hover:bg-yellow-100 rounded flex justify-between items-center">
                            <span>Cola</span>
                            <span class="bg-yellow-200 text-yellow-800 px-2 py-1 rounded text-sm">2.50€</span>
                        </button>
                        <button onclick="addPredefinedOrder('Wasser', 2.00)" class="w-full text-left p-2 hover:bg-yellow-100 rounded flex justify-between items-center">
                            <span>Wasser</span>
                            <span class="bg-yellow-200 text-yellow-800 px-2 py-1 rounded text-sm">2.00€</span>
                        </button>
                        <button onclick="addPredefinedOrder('Apfelsaft', 2.50)" class="w-full text-left p-2 hover:bg-yellow-100 rounded flex justify-between items-center">
                            <span>Apfelsaft</span>
                            <span class="bg-yellow-200 text-yellow-800 px-2 py-1 rounded text-sm">2.50€</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="mb-6">
                <button onclick="toggleCustomOrderForm()" class="flex items-center text-yellow-700 hover:text-yellow-900">
                    <i class="fas fa-plus-circle mr-2"></i> Custom Crepe erstellen
                </button>
                
                <div id="customOrderForm" class="hidden mt-4 bg-yellow-50 p-4 rounded-lg">
                    <h3 class="font-bold text-yellow-800 mb-3">Custom Crepe</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-yellow-700 mb-2">Basis</label>
                            <select id="baseSelect" class="w-full px-4 py-2 border border-yellow-300 rounded-md">
                                <option value="Normal">Normal</option>
                                <option value="Vollkorn">Vollkorn (+0.50€)</option>
                                <option value="Glutenfrei">Glutenfrei (+1.00€)</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-yellow-700 mb-2">Hauptzutat</label>
                            <select id="mainSelect" class="w-full px-4 py-2 border border-yellow-300 rounded-md">
                                <option value="Nutella">Nutella</option>
                                <option value="Zucker-Zitrone">Zucker & Zitrone</option>
                                <option value="Honig">Honig (+0.50€)</option>
                                <option value="Marmelade">Marmelade (+0.50€)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-yellow-700 mb-2">Extras (Mehrfachauswahl möglich)</label>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-2">
                            <label class="inline-flex items-center">
                                <input type="checkbox" class="form-checkbox text-yellow-600" value="Banane (+0.80€)">
                                <span class="ml-2 text-yellow-700">Banane (+0.80€)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" class="form-checkbox text-yellow-600" value="Erdbeeren (+1.00€)">
                                <span class="ml-2 text-yellow-700">Erdbeeren (+1.00€)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" class="form-checkbox text-yellow-600" value="Nüsse (+0.50€)">
                                <span class="ml-2 text-yellow-700">Nüsse (+0.50€)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" class="form-checkbox text-yellow-600" value="Schokostreusel (+0.50€)">
                                <span class="ml-2 text-yellow-700">Schokostreusel (+0.50€)</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="flex justify-between items-center">
                        <div>
                            <span class="font-bold text-yellow-800">Gesamtpreis:</span>
                            <span id="customOrderPrice" class="ml-2 text-lg font-bold">5.00€</span>
                        </div>
                        <button onclick="addCustomOrder()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-md transition duration-300">
                            Hinzufügen
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="bg-white border border-yellow-200 rounded-lg p-4 mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold text-yellow-800">Aktuelle Bestellung</h3>
                    <div>
                        <span class="text-sm text-yellow-600">Gesamt:</span>
                        <span id="currentOrderTotal" class="ml-2 font-bold text-yellow-800">0.00€</span>
                    </div>
                </div>
                
                <div id="currentOrderItems" class="mb-4">
                    <!-- Current order items will be shown here -->
                    <p class="text-yellow-600 text-center py-4">Noch keine Artikel hinzugefügt</p>
                </div>
                
                <div class="flex justify-between items-center">
                    <button onclick="clearCurrentOrder()" class="text-red-600 hover:text-red-800 flex items-center">
                        <i class="fas fa-trash-alt mr-2"></i> Löschen
                    </button>
                    <button onclick="submitOrder()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-md transition duration-300 flex items-center">
                        <i class="fas fa-paper-plane mr-2"></i> Bestellung aufgeben
                    </button>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h3 class="text-lg font-bold text-yellow-800 mb-3">Aktive Bestellungen</h3>
                    <div id="activeOrders" class="space-y-3">
                        <!-- Active orders will be shown here -->
                        <p class="text-yellow-600 text-center py-4">Keine aktiven Bestellungen</p>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-lg font-bold text-yellow-800 mb-3">Fertige Bestellungen</h3>
                    <div id="completedOrders" class="space-y-3">
                        <!-- Completed orders will be shown here -->
                        <p class="text-yellow-600 text-center py-4">Keine fertigen Bestellungen</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Owner View -->
        <div id="ownerView" class="hidden bg-white rounded-lg shadow-md p-6 mb-8">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-yellow-800">Owner Dashboard</h2>
                <div class="flex space-x-4">
                    <button onclick="showAddUserModal()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-md transition duration-300 flex items-center">
                        <i class="fas fa-user-plus mr-2"></i> Benutzer hinzufügen
                    </button>
                    <button onclick="logout()" class="text-yellow-700 hover:text-yellow-900 flex items-center">
                        <i class="fas fa-sign-out-alt mr-2"></i> Ausloggen
                    </button>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-yellow-100 p-6 rounded-lg">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-sm text-yellow-700">Heutige Bestellungen</p>
                            <h3 class="text-3xl font-bold text-yellow-800" id="todayOrdersCount">0</h3>
                        </div>
                        <div class="bg-yellow-200 p-3 rounded-full">
                            <i class="fas fa-clipboard-list text-yellow-700"></i>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="h-2 bg-yellow-200 rounded-full">
                            <div id="todayOrdersProgress" class="h-2 bg-yellow-600 rounded-full" style="width: 0%"></div>
                        </div>
                        <p class="text-xs text-yellow-700 mt-1">Vergleich zu gestern: <span id="ordersComparison">0%</span></p>
                    </div>
                </div>
                
                <div class="bg-yellow-100 p-6 rounded-lg">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-sm text-yellow-700">Heutiger Umsatz</p>
                            <h3 class="text-3xl font-bold text-yellow-800" id="todayRevenue">0.00€</h3>
                        </div>
                        <div class="bg-yellow-200 p-3 rounded-full">
                            <i class="fas fa-euro-sign text-yellow-700"></i>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="h-2 bg-yellow-200 rounded-full">
                            <div id="todayRevenueProgress" class="h-2 bg-yellow-600 rounded-full" style="width: 0%"></div>
                        </div>
                        <p class="text-xs text-yellow-700 mt-1">Vergleich zu gestern: <span id="revenueComparison">0%</span></p>
                    </div>
                </div>
                
                <div class="bg-yellow-100 p-6 rounded-lg">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-sm text-yellow-700">Durchschnittliche Wartezeit</p>
                            <h3 class="text-3xl font-bold text-yellow-800" id="avgWaitTime">0 min</h3>
                        </div>
                        <div class="bg-yellow-200 p-3 rounded-full">
                            <i class="fas fa-clock text-yellow-700"></i>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="h-2 bg-yellow-200 rounded-full">
                            <div id="waitTimeProgress" class="h-2 bg-yellow-600 rounded-full" style="width: 0%"></div>
                        </div>
                        <p class="text-xs text-yellow-700 mt-1">Vergleich zu gestern: <span id="waitTimeComparison">0%</span></p>
                    </div>
                </div>
            </div>
            
            <div class="mb-8">
                <h3 class="text-lg font-bold text-yellow-800 mb-4">Umsatzentwicklung</h3>
                <div class="bg-white p-4 rounded-lg border border-yellow-200">
                    <canvas id="revenueChart" height="300"></canvas>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div>
                    <h3 class="text-lg font-bold text-yellow-800 mb-4">Beliebteste Crepes</h3>
                    <div class="bg-white p-4 rounded-lg border border-yellow-200">
                        <canvas id="popularCrepesChart" height="300"></canvas>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-lg font-bold text-yellow-800 mb-4">Bestellungen nach Tageszeit</h3>
                    <div class="bg-white p-4 rounded-lg border border-yellow-200">
                        <canvas id="ordersByTimeChart" height="300"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="mb-8">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold text-yellow-800">Aktive Bestellungen</h3>
                    <div class="flex space-x-2">
                        <button onclick="refreshOrders()" class="text-yellow-700 hover:text-yellow-900">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button onclick="exportOrders()" class="text-yellow-700 hover:text-yellow-900">
                            <i class="fas fa-file-export"></i>
                        </button>
                    </div>
                </div>
                <div class="bg-white rounded-lg border border-yellow-200 overflow-hidden">
                    <table class="min-w-full divide-y divide-yellow-200">
                        <thead class="bg-yellow-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">Bestellnummer</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">Details</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">Station</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">Aktionen</th>
                            </tr>
                        </thead>
                        <tbody id="ownerOrdersList" class="bg-white divide-y divide-yellow-200">
                            <!-- Active orders will be listed here -->
                            <tr>
                                <td colspan="5" class="px-6 py-4 text-center text-yellow-600">Keine aktiven Bestellungen</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div>
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold text-yellow-800">Mitarbeiter</h3>
                    <button onclick="refreshUsers()" class="text-yellow-700 hover:text-yellow-900">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                <div class="bg-white rounded-lg border border-yellow-200 overflow-hidden">
                    <table class="min-w-full divide-y divide-yellow-200">
                        <thead class="bg-yellow-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">Benutzername</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">Rolle</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">Erstellt am</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">Aktionen</th>
                            </tr>
                        </thead>
                        <tbody id="usersList" class="bg-white divide-y divide-yellow-200">
                            <!-- Users will be listed here -->
                            <tr>
                                <td colspan="4" class="px-6 py-4 text-center text-yellow-600">Keine Mitarbeiter gefunden</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Admin View -->
        <div id="adminView" class="hidden bg-white rounded-lg shadow-md p-6 mb-8">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-yellow-800">Admin Dashboard</h2>
                <div class="flex space-x-4">
                    <button onclick="showAddUserModal()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-md transition duration-300 flex items-center">
                        <i class="fas fa-user-plus mr-2"></i> Benutzer hinzufügen
                    </button>
                    <button onclick="logout()" class="text-yellow-700 hover:text-yellow-900 flex items-center">
                        <i class="fas fa-sign-out-alt mr-2"></i> Ausloggen
                    </button>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <button onclick="switchToView('customer')" class="bg-yellow-100 hover:bg-yellow-200 p-4 rounded-lg flex flex-col items-center transition duration-300">
                    <i class="fas fa-user text-yellow-700 text-2xl mb-2"></i>
                    <span class="text-yellow-800 font-medium">Kundenansicht</span>
                </button>
                <button onclick="switchToView('maker')" class="bg-yellow-100 hover:bg-yellow-200 p-4 rounded-lg flex flex-col items-center transition duration-300">
                    <i class="fas fa-utensils text-yellow-700 text-2xl mb-2"></i>
                    <span class="text-yellow-800 font-medium">Herstelleransicht</span>
                </button>
                <button onclick="switchToView('waiter')" class="bg-yellow-100 hover:bg-yellow-200 p-4 rounded-lg flex flex-col items-center transition duration-300">
                    <i class="fas fa-concierge-bell text-yellow-700 text-2xl mb-2"></i>
                    <span class="text-yellow-800 font-medium">Kellneransicht</span>
                </button>
                <button onclick="switchToView('owner')" class="bg-yellow-100 hover:bg-yellow-200 p-4 rounded-lg flex flex-col items-center transition duration-300">
                    <i class="fas fa-user-tie text-yellow-700 text-2xl mb-2"></i>
                    <span class="text-yellow-800 font-medium">Owneransicht</span>
                </button>
            </div>
            
            <div class="mb-8">
                <h3 class="text-lg font-bold text-yellow-800 mb-4">Systemstatistiken</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-yellow-100 p-6 rounded-lg">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm text-yellow-700">Gesamte Bestellungen</p>
                                <h3 class="text-3xl font-bold text-yellow-800" id="totalOrdersCount">0</h3>
                            </div>
                            <div class="bg-yellow-200 p-3 rounded-full">
                                <i class="fas fa-clipboard-list text-yellow-700"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-yellow-100 p-6 rounded-lg">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm text-yellow-700">Gesamter Umsatz</p>
                                <h3 class="text-3xl font-bold text-yellow-800" id="totalRevenue">0.00€</h3>
                            </div>
                            <div class="bg-yellow-200 p-3 rounded-full">
                                <i class="fas fa-euro-sign text-yellow-700"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-yellow-100 p-6 rounded-lg">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm text-yellow-700">Aktive Benutzer</p>
                                <h3 class="text-3xl font-bold text-yellow-800" id="activeUsersCount">0</h3>
                            </div>
                            <div class="bg-yellow-200 p-3 rounded-full">
                                <i class="fas fa-users text-yellow-700"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mb-8">
                <h3 class="text-lg font-bold text-yellow-800 mb-4">Systemeinstellungen</h3>
                <div class="bg-white p-6 rounded-lg border border-yellow-200">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-yellow-700 mb-2">Standard-Crepe-Preis</label>
                            <div class="flex">
                                <input type="number" id="defaultCrepePrice" class="w-full px-4 py-2 border border-yellow-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-yellow-500" value="4.50" step="0.10">
                                <span class="inline-flex items-center px-3 bg-yellow-100 text-yellow-700 border border-l-0 border-yellow-300 rounded-r-md">€</span>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-yellow-700 mb-2">Durchschnittliche Zubereitungszeit</label>
                            <div class="flex">
                                <input type="number" id="avgPrepTime" class="w-full px-4 py-2 border border-yellow-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-yellow-500" value="5" min="1">
                                <span class="inline-flex items-center px-3 bg-yellow-100 text-yellow-700 border border-l-0 border-yellow-300 rounded-r-md">min</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6">
                        <label class="block text-sm font-medium text-yellow-700 mb-2">Benachrichtigung bei Bestellungsstatus</label>
                        <div class="flex items-center">
                            <input type="checkbox" id="enableNotifications" class="form-checkbox h-5 w-5 text-yellow-600" checked>
                            <span class="ml-2 text-yellow-700">Aktivieren</span>
                        </div>
                    </div>
                    
                    <div class="mt-6 flex justify-end">
                        <button onclick="saveSystemSettings()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-md transition duration-300">
                            Einstellungen speichern
                        </button>
                    </div>
                </div>
            </div>
            
            <div>
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold text-yellow-800">Alle Bestellungen</h3>
                    <div class="flex space-x-2">
                        <button onclick="refreshAllOrders()" class="text-yellow-700 hover:text-yellow-900">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button onclick="exportAllOrders()" class="text-yellow-700 hover:text-yellow-900">
                            <i class="fas fa-file-export"></i>
                        </button>
                    </div>
                </div>
                <div class="bg-white rounded-lg border border-yellow-200 overflow-hidden">
                    <table class="min-w-full divide-y divide-yellow-200">
                        <thead class="bg-yellow-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">Bestellnummer</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">Details</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">Preis</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">Datum</th>
                            </tr>
                        </thead>
                        <tbody id="allOrdersList" class="bg-white divide-y divide-yellow-200">
                            <!-- All orders will be listed here -->
                            <tr>
                                <td colspan="5" class="px-6 py-4 text-center text-yellow-600">Keine Bestellungen gefunden</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Add User Modal -->
        <div id="addUserModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg p-6 w-full max-w-md">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-yellow-800">Benutzer hinzufügen</h3>
                    <button onclick="hideAddUserModal()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="mb-4">
                    <label for="newUsername" class="block text-sm font-medium text-yellow-700 mb-2">Benutzername</label>
                    <input type="text" id="newUsername" class="w-full px-4 py-2 border border-yellow-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500">
                </div>
                
                <div class="mb-4">
                    <label for="newUserPassword" class="block text-sm font-medium text-yellow-700 mb-2">Passwort</label>
                    <input type="password" id="newUserPassword" class="w-full px-4 py-2 border border-yellow-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500">
                </div>
                
                <div class="mb-6">
                    <label for="newUserRole" class="block text-sm font-medium text-yellow-700 mb-2">Rolle</label>
                    <select id="newUserRole" class="w-full px-4 py-2 border border-yellow-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500">
                        <option value="waiter">Kellner</option>
                        <option value="maker">Hersteller</option>
                        <option value="owner">Owner</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
                
                <div class="flex justify-end space-x-3">
                    <button onclick="hideAddUserModal()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-md transition duration-300">
                        Abbrechen
                    </button>
                    <button onclick="addNewUser()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-md transition duration-300">
                        Speichern
                    </button>
                </div>
            </div>
        </div>

        <!-- Order Details Modal -->
        <div id="orderDetailsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-yellow-800">Bestellungsdetails #<span id="modalOrderNumber"></span></h3>
                    <button onclick="hideOrderDetailsModal()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div id="modalOrderDetails" class="mb-4">
                    <!-- Order details will be shown here -->
                </div>
                
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <span class="font-bold text-yellow-800">Gesamtpreis:</span>
                        <span id="modalOrderTotal" class="ml-2 text-lg font-bold">0.00€</span>
                    </div>
                    <div>
                        <span class="font-bold text-yellow-800">Status:</span>
                        <span id="modalOrderStatus" class="ml-2 px-2 py-1 rounded text-sm bg-yellow-200 text-yellow-800">In Bearbeitung</span>
                    </div>
                </div>
                
                <div class="flex justify-end">
                    <button onclick="hideOrderDetailsModal()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-md transition duration-300">
                        Schließen
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Global variables
        let currentUser = null;
        let currentRole = null;
        let currentStation = null;
        let currentOrder = [];
        let allOrders = [];
        let users = [];
        let systemSettings = {
            defaultCrepePrice: 4.50,
            avgPrepTime: 5,
            enableNotifications: true
        };
        
        // Chart.js initialization
        const chartColors = {
            yellow: {
                light: '#FEF3C7',
                medium: '#FCD34D',
                dark: '#F59E0B'
            },
            green: {
                light: '#D1FAE5',
                medium: '#6EE7B7',
                dark: '#10B981'
            },
            blue: {
                light: '#DBEAFE',
                medium: '#93C5FD',
                dark: '#3B82F6'
            }
        };
        
        // DOM Ready
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize UI elements
            initRoleMenu();
            updateCustomOrderPrice();
            
            // Event listeners for custom order form
            document.getElementById('baseSelect').addEventListener('change', updateCustomOrderPrice);
            document.getElementById('mainSelect').addEventListener('change', updateCustomOrderPrice);
            document.querySelectorAll('#customOrderForm input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', updateCustomOrderPrice);
            });
            
            // Load system settings
            loadSystemSettings();
            
            // Check if there's a logged in user (for demo purposes)
            // In a real app, you would check Firebase auth state
            // simulateLogin('admin', 'admin123', 'admin');
        });
        
        // Initialize role menu toggle
        function initRoleMenu() {
            const roleMenuButton = document.getElementById('roleMenuButton');
            const roleMenu = document.getElementById('roleMenu');
            
            roleMenuButton.addEventListener('click', function(e) {
                e.stopPropagation();
                roleMenu.classList.toggle('hidden');
            });
            
            document.addEventListener('click', function() {
                roleMenu.classList.add('hidden');
            });
        }
        
        // Show login modal for specific role
        function showLogin(role) {
            document.getElementById('loginModal').classList.remove('hidden');
            document.getElementById('loginTitle').textContent = `${roleToGerman(role)} Login`;
            document.getElementById('loginButton').setAttribute('data-role', role);
        }
        
        // Hide login modal
        function hideLogin() {
            document.getElementById('loginModal').classList.add('hidden');
        }
        
        // Convert role to German display name
        function roleToGerman(role) {
            const roles = {
                'customer': 'Kunde',
                'maker': 'Hersteller',
                'waiter': 'Kellner',
                'owner': 'Owner',
                'admin': 'Admin'
            };
            return roles[role] || role;
        }
        
        // Login function
        function login() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            const role = document.getElementById('loginButton').getAttribute('data-role');
            
            // Simple validation
            if (!username || !password) {
                alert('Bitte Benutzername und Passwort eingeben');
                return;
            }
            
            // In a real app, you would authenticate with Firebase
            // For this demo, we'll simulate authentication
            simulateLogin(username, password, role);
        }
        
        // Simulate login (replace with Firebase auth in real app)
        function simulateLogin(username, password, role) {
            // Hide login modal
            hideLogin();
            
            // Set current user
            currentUser = {
                username: username,
                role: role
            };
            currentRole = role;
            
            // Show appropriate view based on role
            showViewForRole(role);
            
            // Load data for the view
            loadDataForView(role);
            
            // Clear login form
            document.getElementById('loginUsername').value = '';
            document.getElementById('loginPassword').value = '';
        }
        
        // Show appropriate view based on user role
        function showViewForRole(role) {
            // Hide all views first
            document.getElementById('customerView').classList.add('hidden');
            document.getElementById('makerView').classList.add('hidden');
            document.getElementById('waiterView').classList.add('hidden');
            document.getElementById('ownerView').classList.add('hidden');
            document.getElementById('adminView').classList.add('hidden');
            
            // Show the correct view
            if (role === 'customer') {
                document.getElementById('customerView').classList.remove('hidden');
            } else if (role === 'maker') {
                document.getElementById('makerView').classList.remove('hidden');
            } else if (role === 'waiter') {
                document.getElementById('waiterView').classList.remove('hidden');
            } else if (role === 'owner') {
                document.getElementById('ownerView').classList.remove('hidden');
            } else if (role === 'admin') {
                document.getElementById('adminView').classList.remove('hidden');
            }
        }
        
        // Load data for the current view
        function loadDataForView(role) {
            // In a real app, you would fetch data from Firebase
            // For this demo, we'll simulate data loading
            
            if (role === 'customer') {
                // Nothing special to load for customer view
            } else if (role === 'maker') {
                // Load maker data
                loadMakerData();
            } else if (role === 'waiter') {
                // Load waiter data
                loadWaiterData();
            } else if (role === 'owner' || role === 'admin') {
                // Load owner/admin data
                loadOwnerData();
                if (role === 'admin') {
                    loadAdminData();
                }
            }
        }
        
        // Load maker data
        function loadMakerData() {
            // Simulate loading orders for maker
            simulateOrdersForMaker();
        }
        
        // Load waiter data
        function loadWaiterData() {
            // Simulate loading orders for waiter
            simulateOrdersForWaiter();
        }
        
        // Load owner data
        function loadOwnerData() {
            // Simulate loading data for owner
            simulateDataForOwner();
            
            // Initialize charts
            initCharts();
        }
        
        // Load admin data
        function loadAdminData() {
            // Simulate loading data for admin
            simulateDataForAdmin();
        }
        
        // Simulate orders for maker view
        function simulateOrdersForMaker() {
            // This would come from Firebase in a real app
            const orders = [
                {
                    id: 'CR1001',
                    items: [
                        { name: 'Nutella Crepe', price: 5.00 },
                        { name: 'Cola', price: 2.50 }
                    ],
                    status: 'in_progress',
                    station: 1,
                    timestamp: new Date().getTime() - 60000 // 1 minute ago
                },
                {
                    id: 'CR1002',
                    items: [
                        { name: 'Erdbeer-Nutella Crepe', price: 6.00 }
                    ],
                    status: 'queued',
                    station: 1,
                    timestamp: new Date().getTime()
                },
                {
                    id: 'CR1003',
                    items: [
                        { name: 'Classic Crepe', price: 4.50 },
                        { name: 'Apfelsaft', price: 2.50 }
                    ],
                    status: 'queued',
                    station: 2,
                    timestamp: new Date().getTime() - 30000 // 30 seconds ago
                }
            ];
            
            // Display orders based on selected station
            updateMakerOrdersDisplay(orders);
        }
        
        // Simulate orders for waiter view
        function simulateOrdersForWaiter() {
            // This would come from Firebase in a real app
            const activeOrders = [
                {
                    id: 'CR1001',
                    items: [
                        { name: 'Nutella Crepe', price: 5.00 },
                        { name: 'Cola', price: 2.50 }
                    ],
                    status: 'in_progress',
                    station: 1,
                    total: 7.50,
                    timestamp: new Date().getTime() - 120000 // 2 minutes ago
                }
            ];
            
            const completedOrders = [
                {
                    id: 'CR999',
                    items: [
                        { name: 'Classic Crepe', price: 4.50 },
                        { name: 'Wasser', price: 2.00 }
                    ],
                    status: 'completed',
                    station: 2,
                    total: 6.50,
                    timestamp: new Date().getTime() - 3600000 // 1 hour ago
                }
            ];
            
            // Display orders
            updateWaiterOrdersDisplay(activeOrders, completedOrders);
        }
        
        // Simulate data for owner view
        function simulateDataForOwner() {
            // This would come from Firebase in a real app
            const orders = [
                {
                    id: 'CR1001',
                    items: [
                        { name: 'Nutella Crepe', price: 5.00 },
                        { name: 'Cola', price: 2.50 }
                    ],
                    status: 'in_progress',
                    station: 1,
                    total: 7.50,
                    timestamp: new Date().getTime() - 120000 // 2 minutes ago
                },
                {
                    id: 'CR1002',
                    items: [
                        { name: 'Erdbeer-Nutella Crepe', price: 6.00 }
                    ],
                    status: 'queued',
                    station: 1,
                    total: 6.00,
                    timestamp: new Date().getTime() - 60000 // 1 minute ago
                },
                {
                    id: 'CR1003',
                    items: [
                        { name: 'Classic Crepe', price: 4.50 },
                        { name: 'Apfelsaft', price: 2.50 }
                    ],
                    status: 'queued',
                    station: 2,
                    total: 7.00,
                    timestamp: new Date().getTime() - 30000 // 30 seconds ago
                }
            ];
            
            const users = [
                {
                    username: 'chef1',
                    role: 'owner',
                    created: new Date().getTime() - 86400000 // 1 day ago
                },
                {
                    username: 'maker1',
                    role: 'maker',
                    created: new Date().getTime() - 43200000 // 12 hours ago
                },
                {
                    username: 'waiter1',
                    role: 'waiter',
                    created: new Date().getTime() - 21600000 // 6 hours ago
                }
            ];
            
            // Display data
            updateOwnerOrdersDisplay(orders);
            updateUsersList(users);
            
            // Update stats
            updateOwnerStats(orders, users);
        }
        
        // Simulate data for admin view
        function simulateDataForAdmin() {
            // This would come from Firebase in a real app
            const allOrders = [
                {
                    id: 'CR1001',
                    items: [
                        { name: 'Nutella Crepe', price: 5.00 },
                        { name: 'Cola', price: 2.50 }
                    ],
                    status: 'in_progress',
                    station: 1,
                    total: 7.50,
                    timestamp: new Date().getTime() - 120000 // 2 minutes ago
                },
                {
                    id: 'CR1002',
                    items: [
                        { name: 'Erdbeer-Nutella Crepe', price: 6.00 }
                    ],
                    status: 'queued',
                    station: 1,
                    total: 6.00,
                    timestamp: new Date().getTime() - 60000 // 1 minute ago
                },
                {
                    id: 'CR1003',
                    items: [
                        { name: 'Classic Crepe', price: 4.50 },
                        { name: 'Apfelsaft', price: 2.50 }
                    ],
                    status: 'queued',
                    station: 2,
                    total: 7.00,
                    timestamp: new Date().getTime() - 30000 // 30 seconds ago
                },
                {
                    id: 'CR999',
                    items: [
                        { name: 'Classic Crepe', price: 4.50 },
                        { name: 'Wasser', price: 2.00 }
                    ],
                    status: 'completed',
                    station: 2,
                    total: 6.50,
                    timestamp: new Date().getTime() - 3600000 // 1 hour ago
                },
                {
                    id: 'CR998',
                    items: [
                        { name: 'Haus-Spezial', price: 7.00 }
                    ],
                    status: 'completed',
                    station: 3,
                    total: 7.00,
                    timestamp: new Date().getTime() - 7200000 // 2 hours ago
                }
            ];
            
            // Display all orders
            updateAllOrdersList(allOrders);
            
            // Update admin stats
            updateAdminStats(allOrders);
        }
        
        // Update maker orders display
        function updateMakerOrdersDisplay(orders) {
            const currentOrderContainer = document.getElementById('currentOrder');
            const noOrdersContainer = document.getElementById('noOrders');
            const queueList = document.getElementById('queueList');
            
            if (currentStation) {
                // Filter orders for current station
                const stationOrders = orders.filter(order => order.station === currentStation);
                const inProgressOrder = stationOrders.find(order => order.status === 'in_progress');
                const queuedOrders = stationOrders.filter(order => order.status === 'queued');
                
                if (inProgressOrder) {
                    // Show current order
                    currentOrderContainer.classList.remove('hidden');
                    noOrdersContainer.classList.add('hidden');
                    
                    document.getElementById('currentOrderNumber').textContent = inProgressOrder.id;
                    
                    const orderDetails = document.getElementById('orderDetails');
                    orderDetails.innerHTML = '';
                    
                    inProgressOrder.items.forEach(item => {
                        const itemElement = document.createElement('div');
                        itemElement.className = 'flex justify-between py-1 border-b border-yellow-100';
                        itemElement.innerHTML = `
                            <span>${item.name}</span>
                            <span class="font-bold">${item.price.toFixed(2)}€</span>
                        `;
                        orderDetails.appendChild(itemElement);
                    });
                    
                    // Calculate time elapsed
                    const elapsedMinutes = Math.floor((new Date().getTime() - inProgressOrder.timestamp) / 60000);
                    document.getElementById('stationStatus').textContent = `In Bearbeitung (${elapsedMinutes} min)`;
                } else {
                    // No current order
                    currentOrderContainer.classList.add('hidden');
                    
                    if (queuedOrders.length > 0) {
                        noOrdersContainer.classList.add('hidden');
                    } else {
                        noOrdersContainer.classList.remove('hidden');
                    }
                }
                
                // Update queue
                queueList.innerHTML = '';
                
                if (queuedOrders.length > 0) {
                    queuedOrders.forEach(order => {
                        const orderElement = document.createElement('div');
                        orderElement.className = 'order-card bg-yellow-50 p-3 rounded-lg';
                        orderElement.innerHTML = `
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-bold">#${order.id}</span>
                                <span class="text-sm bg-yellow-200 text-yellow-800 px-2 py-1 rounded">Wartend</span>
                            </div>
                            <div class="text-sm text-yellow-700">
                                ${order.items.map(item => item.name).join(', ')}
                            </div>
                        `;
                        queueList.appendChild(orderElement);
                    });
                } else {
                    const emptyElement = document.createElement('div');
                    emptyElement.className = 'text-center text-yellow-600 py-4';
                    emptyElement.textContent = 'Keine Bestellungen in der Warteschlange';
                    queueList.appendChild(emptyElement);
                }
            } else {
                // No station selected
                currentOrderContainer.classList.add('hidden');
                noOrdersContainer.classList.remove('hidden');
                queueList.innerHTML = '';
                
                const emptyElement = document.createElement('div');
                emptyElement.className = 'text-center text-yellow-600 py-4';
                emptyElement.textContent = 'Bitte wählen Sie eine Station aus';
                queueList.appendChild(emptyElement);
            }
        }
        
        // Update waiter orders display
        function updateWaiterOrdersDisplay(activeOrders, completedOrders) {
            const currentOrderTotal = document.getElementById('currentOrderTotal');
            const currentOrderItems = document.getElementById('currentOrderItems');
            const activeOrdersContainer = document.getElementById('activeOrders');
            const completedOrdersContainer = document.getElementById('completedOrders');
            
            // Update current order total
            const total = currentOrder.reduce((sum, item) => sum + item.price, 0);
            currentOrderTotal.textContent = `${total.toFixed(2)}€`;
            
            // Update current order items
            currentOrderItems.innerHTML = '';
            
            if (currentOrder.length > 0) {
                currentOrder.forEach((item, index) => {
                    const itemElement = document.createElement('div');
                    itemElement.className = 'flex justify-between items-center py-2 border-b border-yellow-100';
                    itemElement.innerHTML = `
                        <span>${item.name}</span>
                        <div class="flex items-center">
                            <span class="font-bold mr-4">${item.price.toFixed(2)}€</span>
                            <button onclick="removeOrderItem(${index})" class="text-red-500 hover:text-red-700">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    `;
                    currentOrderItems.appendChild(itemElement);
                });
            } else {
                const emptyElement = document.createElement('p');
                emptyElement.className = 'text-yellow-600 text-center py-4';
                emptyElement.textContent = 'Noch keine Artikel hinzugefügt';
                currentOrderItems.appendChild(emptyElement);
            }
            
            // Update active orders
            activeOrdersContainer.innerHTML = '';
            
            if (activeOrders.length > 0) {
                activeOrders.forEach(order => {
                    const orderElement = document.createElement('div');
                    orderElement.className = 'order-card bg-white border border-yellow-200 p-4 rounded-lg';
                    orderElement.innerHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-bold">#${order.id}</span>
                            <span class="text-sm bg-yellow-200 text-yellow-800 px-2 py-1 rounded">In Bearbeitung</span>
                        </div>
                        <div class="text-sm text-yellow-700 mb-2">
                            ${order.items.map(item => item.name).join(', ')}
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-bold">${order.total.toFixed(2)}€</span>
                            <button onclick="viewOrderDetails('${order.id}')" class="text-yellow-700 hover:text-yellow-900 text-sm">
                                <i class="fas fa-eye mr-1"></i> Details
                            </button>
                        </div>
                    `;
                    activeOrdersContainer.appendChild(orderElement);
                });
            } else {
                const emptyElement = document.createElement('p');
                emptyElement.className = 'text-yellow-600 text-center py-4';
                emptyElement.textContent = 'Keine aktiven Bestellungen';
                activeOrdersContainer.appendChild(emptyElement);
            }
            
            // Update completed orders
            completedOrdersContainer.innerHTML = '';
            
            if (completedOrders.length > 0) {
                completedOrders.forEach(order => {
                    const orderElement = document.createElement('div');
                    orderElement.className = 'order-card bg-white border border-green-200 p-4 rounded-lg';
                    orderElement.innerHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-bold">#${order.id}</span>
                            <span class="text-sm bg-green-200 text-green-800 px-2 py-1 rounded">Fertig</span>
                        </div>
                        <div class="text-sm text-yellow-700 mb-2">
                            ${order.items.map(item => item.name).join(', ')}
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-bold">${order.total.toFixed(2)}€</span>
                            <button onclick="viewOrderDetails('${order.id}')" class="text-yellow-700 hover:text-yellow-900 text-sm">
                                <i class="fas fa-eye mr-1"></i> Details
                            </button>
                        </div>
                    `;
                    completedOrdersContainer.appendChild(orderElement);
                });
            } else {
                const emptyElement = document.createElement('p');
                emptyElement.className = 'text-yellow-600 text-center py-4';
                emptyElement.textContent = 'Keine fertigen Bestellungen';
                completedOrdersContainer.appendChild(emptyElement);
            }
        }
        
        // Update owner orders display
        function updateOwnerOrdersDisplay(orders) {
            const ownerOrdersList = document.getElementById('ownerOrdersList');
            
            ownerOrdersList.innerHTML = '';
            
            if (orders.length > 0) {
                orders.forEach(order => {
                    const row = document.createElement('tr');
                    
                    // Format timestamp
                    const orderDate = new Date(order.timestamp);
                    const timeString = orderDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-yellow-800">${order.id}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-yellow-700">
                            ${order.items.slice(0, 2).map(item => item.name).join(', ')}${order.items.length > 2 ? '...' : ''}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-yellow-700">Station ${order.station}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span
</html>
